---
title: "MP4"
author: "Sam Ellinwood, Haley McAtee, Sam Schneider"
date: "11/28/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(mdsr)
library(tidyverse)
library(RMySQL)
```

```{r}
db <- dbConnect_scidb(dbname = "imdb")
tbl_1 <- db %>%
  dbGetQuery("SELECT DISTINCT t1.movie_id, t1.title, t1.production_year, t2.movie_id
FROM (SELECT DISTINCT aka_title.movie_id, title, production_year FROM aka_title) AS t1
JOIN (SELECT DISTINCT movie_keyword.movie_id FROM movie_keyword JOIN imdb.keyword ON keyword.id = movie_keyword.keyword_id 
	WHERE keyword.id = 1149 OR keyword.id = 4232
	OR keyword.id = 4671 OR keyword.id = 4672 OR keyword.id = 4669) AS t2
ON t1.movie_id = t2.movie_id;")
```

```{r}
tbl_1 <- tbl_1[, !duplicated(colnames(tbl_1))]
tbl_1 %>%
  filter(production_year > 1900, production_year < 2017) %>%
  group_by(production_year) %>%
  summarize("num_movies" = n())  %>%
  ggplot(aes(x = production_year, y = num_movies)) + 
  geom_point() + 
  geom_smooth() +
  scale_x_continuous(breaks=seq(1900,2017,20)) +
  ggtitle("Terrorism Movies from 1900-2017") +
  labs(x="Year",y="Number of Movies")
  
```

